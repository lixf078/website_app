<!doctype html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,initial-scale=1.0,width=device-width" />
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <title>Hello APP</title>
    <link rel="stylesheet" type="text/css" href="./css/api.css" />
    <style type="text/css">
        html,
        body {
            height: 100%;
        }
        .wrap {
            display: -webkit-box;
            -webkit-box-orient: vertical;
            -webkit-flex-flow: column;
        }

        header {
            width: 100%;
            text-align: center;

            color: #fff;
        }

        .flex-1 {
            -webkit-box-flex: 1;
            -webkit-flex: 1;
        }

        footer {
            width: 100%;

            color: white;

            text-align: center;
        }
    </style>
</head>

<body class="wrap">
    <header></header>
    <section class="flex-1">

    </section>
    <footer></footer>
</body>
<script type="text/javascript" src="./script/api.js"></script>
<script type="text/javascript">
    apiready = function() {
        //输出Log，Log将显示在APICloud Studio控制台
      //  console.log("Hello World! Hello APICloud!");

        var header = $api.dom('header'); // 获取 header 标签元素
        var footer = $api.dom('footer'); // 获取 footer 标签元素

        // 1.修复开启沉浸式效果带来的顶部Header与手机状态栏重合的问题，最新api.js方法已支持适配iPhoneX；
        // 2.默认已开启了沉浸式效果 config.xml中 <preference name="statusBarAppearance" value="true"/>
        // 3.沉浸式效果适配支持iOS7+，Android4.4+以上版本
        var headerH = $api.fixStatusBar(header);
        // 最新api.js为了适配iPhoneX增加的方法，修复底部Footer部分与iPhoneX的底部虚拟横条键重叠的问题；
        var footerH = $api.fixTabBar(footer);
        //alert($api.getStorage('mid'));
        //设置mid
        if($api.getStorage('mid')==undefined||$api.getStorage('mid')==null||$api.getStorage('mid')==""){
                $api.setStorage('mid', 'oppo');
              //  alert($api.getStorage('mid'));
        }

      //极光推送
        var ajpush = api.require('ajpush');

        ajpush.init(function(ret) {
            if (ret && ret.status){
                //success
            }
        });
        //极光推送
        api.openWin({
            name: 'main',

            url: 'jhd/main.html',
            rect: { // 推荐使用Margin布局，用于适配屏幕的动态变化
                marginBottom: footerH, // main页面距离win底部的高度
                w: 'auto' // main页面的宽度 自适应屏幕宽度

            }
        });
        api.setStatusBarStyle({
            style: 'light'
        });
        api.requestPermission({
            list:['storage'],
            code:1
        }, function(ret, err){
          //alert(ret.list[0].granted);
          if(!ret.list[0].granted){
            api.alert(
              '请开启设备存储权限'
            )
            var openset = api.require('openSet');
            openset.open({
                id: 8
            });
          }
        });
        //shareinstall开始
        /*
        var shareinstall = api.require('shareinstall');
        api.addEventListener({
            name: 'appintent'
        }, function(ret, err) {
            shareinstall.getWakeup({
                "uri": ret.data //android需要参数，ios不需要传参
            }, function(ret, err) {
                alert("唤醒参数：" + JSON.stringify(ret));
            });
        });

        shareinstall.getInstall({}, function(ret, err) {
            alert("安装"+JSON.stringify(ret));
        });
        */
        //shareinstall结束

    };

</script>

</html>
